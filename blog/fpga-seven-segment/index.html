<!doctype html><html lang=en-gb dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Rust, FPGAs, and Seven Segment Displays &#183; joeyh.dev</title><meta name=title content="Rust, FPGAs, and Seven Segment Displays &#183; joeyh.dev"><link rel=canonical href=https://joeyh.dev/blog/fpga-seven-segment/><link type=text/css rel=stylesheet href=/css/main.bundle.min.16df8a8c7ab2ae1cddbe6a3f9d7d902d38ec61378f1b7d42d7eae2b9456f888176e32ab53c89fe0cd94e82669ffc17fed3eaa65aa0b7bc4171eadee2611412ee.css integrity="sha512-Ft+KjHqyrhzdvmo/nX2QLTjsYTePG31C1+riuUVviIF24yq1PIn+DNlOgmaf/Bf+0+qmWqC3vEFx6t7iYRQS7g=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Rust, FPGAs, and Seven Segment Displays"><meta property="og:description" content="My experience building and programming a simple I/O device for a RISC-V core on an FPGA."><meta property="og:type" content="article"><meta property="og:url" content="https://joeyh.dev/blog/fpga-seven-segment/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-07-31T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-31T00:00:00+00:00"><meta property="og:site_name" content="joeyh.dev"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rust, FPGAs, and Seven Segment Displays"><meta name=twitter:description content="My experience building and programming a simple I/O device for a RISC-V core on an FPGA."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"Rust, FPGAs, and Seven Segment Displays","headline":"Rust, FPGAs, and Seven Segment Displays","description":"My experience building and programming a simple I\/O device for a RISC-V core on an FPGA.","abstract":"Getting my feet wet with FPGA design","inLanguage":"en","url":"https:\/\/joeyh.dev\/blog\/fpga-seven-segment\/","author":{"@type":"Person","name":"Joey Harrison"},"copyrightYear":"2022","dateCreated":"2022-07-31T00:00:00\u002b00:00","datePublished":"2022-07-31T00:00:00\u002b00:00","dateModified":"2022-07-31T00:00:00\u002b00:00","mainEntityOfPage":"true","wordCount":"2441"}]</script><meta name=author content="Joey Harrison"><link href=https://github.com/Joeyh021 rel=me><link href=https://linkedin.com/in/joe-h-a991771b6/ rel=me><link href=https://twitter.com/Joeyh021 rel=me><link href=mailto:joeyh021@icloud.com rel=me><script async src="https://www.googletagmanager.com/gtag/js?id=G-3SF9FYH15D"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3SF9FYH15D",{anonymize_ip:!1})}</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><nav class="flex justify-between"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>joeyh.dev</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blog>Blog</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://joeyh.dev/notes title>Notes</a></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>joeyh.dev</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/blog/>Blog</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/blog/fpga-seven-segment/>Rust, FPGAs, and Seven Segment Displays</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Rust, FPGAs, and Seven Segment Displays</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-07-31 00:00:00 +0000 UTC">31 July 2022</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="min-w-0 min-h-0 max-w-prose"><p>The title of my third year project is &ldquo;Programmable I/O for Flexible Interfaces in Embedded RISC-V Systems&rdquo;, which basically just means making something very similar to the <a href=https://hackspace.raspberrypi.com/articles/what-is-programmable-i-o-on-raspberry-pi-pico>Programmable I/O blocks on the Raspberry Pi Pico</a> (which I think are insanely cool), and then integrating them with a RISC-V core to create a simple microcontroller that can interface with basically anything at fairly low power. This means a lot of work with FPGAs and Verilog/HDL which are two things I don&rsquo;t have much experience with.</p><p>I did do an introductory digital systems design course as part of my degree last year, and learned a bit about Verilog and FPGA design & architecture. The coursework was making a video game (a very common application for FPGAs, of course), and our shitty asteroids clone was mostly thrown together in one very long week of late nights spent fighting with Xilinx Vivado, the FPGA IDE and toolchain, and also perhaps the worst piece of software ever. However, going from making an arcade game to a microcontroller is a big leap that&rsquo;s going to require a lot of learning.</p><p>So instead of revising for my exams, I spent a few days trying to get to grips better with Xilinx&rsquo;s design tools and FPGA work in general by designing a hardware interface for a seven segment display, integrating it with an existing RISC-V core, and then writing a software driver for it in Rust.</p><p><figure><img class="my-0 rounded-md" src=./display.gif alt="The 7 segment display"><figcaption>I taught a computer to count!</figcaption></figure></p><h2 id=getting-going class="relative group">Getting Going <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#getting-going aria-label=Anchor>#</a></span></h2><p>My staring point was <a href=https://github.com/eugene-tarassov/vivado-risc-v>this GitHub repo</a>, which was basically perfect because it provides a RISC-V SoC with UART, Ethernet, an SD card controller, and scripts to build bootloaders and the Linux kernel. It was literally as easy running <code>make</code> as per the instructions, flashing the kernel onto an SD card, and then connecting over the serial port. I had Debian up and running on the Nexys A7 board the School of Engineering had kindly let me borrow with surprisingly little difficulty. The Vivado block design of the SoC is shown below, it&rsquo;s just a core hooked up to the onboard DDR2 memory and a few I/O components using AXI buses.</p><p><figure><img class="my-0 rounded-md" srcset="/blog/fpga-seven-segment/block-design_hu5cfb2a6c29f9f7eff9dfd32bcd4ef58b_266726_330x0_resize_box_3.png 330w,
/blog/fpga-seven-segment/block-design_hu5cfb2a6c29f9f7eff9dfd32bcd4ef58b_266726_660x0_resize_box_3.png 660w,
/blog/fpga-seven-segment/block-design_hu5cfb2a6c29f9f7eff9dfd32bcd4ef58b_266726_1024x0_resize_box_3.png 1024w,
/blog/fpga-seven-segment/block-design_hu5cfb2a6c29f9f7eff9dfd32bcd4ef58b_266726_1320x0_resize_box_3.png 2x" src=/blog/fpga-seven-segment/block-design_hu5cfb2a6c29f9f7eff9dfd32bcd4ef58b_266726_660x0_resize_box_3.png alt="Block design of the CPU"><figcaption>The SoC, as seen in Vivado. Expand the image to see in more detail.</figcaption></figure></p><p>The CPU core used is <a href=https://github.com/chipsalliance/rocket-chip>Rocket Chip</a>, an open-source RISC-V SoC generator built and maintained by UC Berkeley Architecture Research. Rocket Chip can generate a RTL RISC-V implementation that has virtual memory, a coherent multi-level cache hierarchy, IEEE-compliant floating-point units, and all the other bits and bobs you need for a useful CPU. All the HDL is entirely parametrised, so can be customised to generate whatever kind of core takes your fancy. It&rsquo;s written in CHISEL, a HDL embedded in Scala, which is what enables this. Scala for HDL sounds cool (read: better than Verilog, which is not much competition), and I really want to try it out at some point.</p><p>Linux running on an FPGA was cool, but I didn&rsquo;t do much with it besides brag about it on IRC.</p><p><figure><img class="my-0 rounded-md" srcset="/blog/fpga-seven-segment/irc_hu85e116c67ee99f4c6acfa9634526f41d_5220_330x0_resize_box_3.png 330w,
/blog/fpga-seven-segment/irc_hu85e116c67ee99f4c6acfa9634526f41d_5220_660x0_resize_box_3.png 660w,
/blog/fpga-seven-segment/irc_hu85e116c67ee99f4c6acfa9634526f41d_5220_1024x0_resize_box_3.png 1024w,
/blog/fpga-seven-segment/irc_hu85e116c67ee99f4c6acfa9634526f41d_5220_1320x0_resize_box_3.png 2x" src=/blog/fpga-seven-segment/irc_hu85e116c67ee99f4c6acfa9634526f41d_5220_660x0_resize_box_3.png alt="IRC Bragging"><figcaption>Yes, it&rsquo;s technically discord, we have a chat bridge.</figcaption></figure></p><p>Instead, I went back and compiled <a href=https://github.com/eugene-tarassov/vivado-risc-v/tree/master/bare-metal>the bare metal example</a> because Linux was super slow, and writing bare metal drivers is much simpler than Linux drivers (part 2, perhaps?). The example is just sending hello world over the serial port by writing to the UART registers, but the key bit is the linker script and startup code, which will come in handy later. The more observant among you will notice one problem with this code though&mldr;</p><h2 id=crab-time class="relative group">Crab Time <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#crab-time aria-label=Anchor>#</a></span></h2><p>It&rsquo;s written in C, so obviously it needed the Rewrite It In Rust treatment. My idea was to create a minimal <code>no-std</code> executable using the <a href><code>riscv-rt</code></a> crate, which is meant to provide a startup and runtime for embedded RISC-V targets. Of course, it couldn&rsquo;t be that simple, and I ended up spending the best part of a day grappling with rustc/lld to generate me an executable that would run, all to no avail. I probably tried every command line flag and cargo configuration parameter in existence, but could not for the life of me get anything to work using <code>riscv-rt</code> . My hacky solution in the end was to just compile a rust crate without <code>riscv-rt</code> to a static library exposing only <code>main</code>, and then invoke the GCC cross-compiler to link using the linker script and startup assembly code from the example. This worked without any trouble, and I had Rust code running on an FPGA!</p><p><figure><img class="my-0 rounded-md" srcset="/blog/fpga-seven-segment/hello-from-rust_hu2fed44f2c98754afdc8e95fa004fe955_7803_330x0_resize_box_3.png 330w,
/blog/fpga-seven-segment/hello-from-rust_hu2fed44f2c98754afdc8e95fa004fe955_7803_660x0_resize_box_3.png 660w,
/blog/fpga-seven-segment/hello-from-rust_hu2fed44f2c98754afdc8e95fa004fe955_7803_1024x0_resize_box_3.png 1024w,
/blog/fpga-seven-segment/hello-from-rust_hu2fed44f2c98754afdc8e95fa004fe955_7803_1320x0_resize_box_3.png 2x" src=/blog/fpga-seven-segment/hello-from-rust_hu2fed44f2c98754afdc8e95fa004fe955_7803_660x0_resize_box_3.png alt="Hello from Rust!"><figcaption>At least the serial interface works.</figcaption></figure></p><p>The serial interface code is shown below. The hardware has 4 registers: Rx, Tx, and control and status registers. I can&rsquo;t find much documentation on how to use the control/status registers besides the example code, but the idea is simple enough: put some bytes in the Tx register, and it gets sent to the console on the other end.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>pub</span><span class=w> </span><span class=k>struct</span> <span class=nc>Serial</span><span class=p>(</span><span class=o>&amp;&#39;</span><span class=nb>static</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>UartRegs</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[repr(C)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>struct</span> <span class=nc>UartRegs</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>rx_fifo</span>: <span class=nc>RO</span><span class=o>&lt;</span><span class=kt>u32</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tx_fifo</span>: <span class=nc>WO</span><span class=o>&lt;</span><span class=kt>u32</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>status</span>: <span class=nc>RO</span><span class=o>&lt;</span><span class=kt>u32</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>control</span>: <span class=nc>RW</span><span class=o>&lt;</span><span class=kt>u32</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>impl</span><span class=w> </span><span class=n>Serial</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=k>unsafe</span><span class=w> </span><span class=k>fn</span> <span class=nf>new</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>Self</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Serial</span><span class=p>((</span><span class=n>UART_ADDR</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=o>*</span><span class=k>mut</span><span class=w> </span><span class=n>UartRegs</span><span class=p>).</span><span class=n>as_mut</span><span class=p>().</span><span class=n>unwrap</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>write_byte</span><span class=p>(</span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=bp>self</span><span class=p>,</span><span class=w> </span><span class=n>byte</span>: <span class=kt>u8</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=bp>self</span><span class=p>.</span><span class=mf>0.</span><span class=n>status</span><span class=p>.</span><span class=n>read</span><span class=p>()</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>SR_TX_FIFO_FULL</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>unsafe</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=bp>self</span><span class=p>.</span><span class=mf>0.</span><span class=n>tx_fifo</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>byte</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>u32</span><span class=p>)</span><span class=w> </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>I&rsquo;m using <a href><code>volatile_register</code></a>, which provides read-only, write-only and read-write cells with volalile access for modelling CPU registers. Rust really shines here, as I can encode what functions are read-only and what requires a write in the type system, and through the use of immutable vs mutable references. Writes are also effectful, so require <code>unsafe</code> blocks, whereas reads do not. The <code>#[repr(C)]</code> is needed as <a href=https://doc.rust-lang.org/reference/type-layout.html>Rust makes no guarantees on struct layout</a>, so we need to tell the compiler to lay the data out in the way C would (which is the way you would expect) to be able to just cast our address to a <code>*mut UartRegs</code> and it work.</p><h2 id=the-display-controller class="relative group">The Display Controller <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-display-controller aria-label=Anchor>#</a></span></h2><p>So I had the bare minimum working, it was time to extend it with something a little more exciting. The 7 segment display on my board has a hardware interface that looks like the following:</p><p><figure><img class="my-0 rounded-md" src=./7seg.png alt="The 7 segment display "><figcaption>A 4-digit 7 segment display module (of which this board has two)</figcaption></figure></p><p>Each digit has it&rsquo;s own common anode, and all the same segments on each digit share a pin. This means it&rsquo;s fairly easy to write a controller which controls all the digits in unison: tie all the anodes high, and then work out what patterns of segment signals correspond to each digit. In Verilog, that&rsquo;s a simple behavioural case statement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Verilog data-lang=Verilog><span class=line><span class=cl><span class=k>always</span><span class=p>@</span><span class=o>*</span> <span class=k>begin</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=p>(</span><span class=n>number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// lots of bit patterns
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=mh>4&#39;h0</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1111110</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h1</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b0110000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h2</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1101101</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h3</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1111001</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h4</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b0110011</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h5</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1011011</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h6</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1011111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h7</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1110000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h8</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1111111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;h9</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1111011</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;ha</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1110111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;hb</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b0011111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;hc</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1001110</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;hd</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b0111101</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;he</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1001111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=mh>4&#39;hf</span><span class=o>:</span> <span class=n>digit</span> <span class=o>=</span> <span class=mh>7</span><span class=mb>&#39;b1000111</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>endcase</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div><p>Controlling each digit individually is a bit harder, as the segments are all connected together. The way to do it is to strobe the anodes, having only one of them active at a time and displaying the segment pattern that we want, but strobe it fast enough that our eyes can&rsquo;t tell that only one digit is on at a time. The onboard clock is 100MHz, so we use a 20-bit counter to slow that down to a much more tame ~100Hz, and select which of the 8 digits is active.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Verilog data-lang=Verilog><span class=line><span class=cl><span class=c1>//divide the 100mhz clock to something a little slower
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>reg</span> <span class=p>[</span><span class=mh>19</span><span class=o>:</span><span class=mh>0</span><span class=p>]</span> <span class=n>clk_count</span> <span class=o>=</span> <span class=mh>20</span><span class=mi>&#39;d0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>always</span> <span class=p>@</span> <span class=p>(</span><span class=k>posedge</span> <span class=n>clk</span><span class=p>)</span> <span class=n>clk_count</span> <span class=o>&lt;=</span> <span class=n>clk_count</span> <span class=o>+</span> <span class=mh>1</span><span class=mb>&#39;b1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//use most significant 3 bits to count which LED is active
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>wire</span> <span class=p>[</span><span class=mh>2</span><span class=o>:</span><span class=mh>0</span><span class=p>]</span> <span class=n>active_digit</span> <span class=o>=</span> <span class=n>clk_count</span><span class=p>[</span><span class=mh>19</span><span class=o>:</span><span class=mh>17</span><span class=p>];</span>
</span></span></code></pre></div><p>For those of you not familiar with verilog:</p><ul><li><code>reg [19:0]</code> defines a register that is 20 bits wide</li><li><code>20'd0</code> is a numeric literal that is 20 bits wide, specified in decimal, with the value 0<ul><li>Yes, really, that&rsquo;s the syntax.</li></ul></li><li><code>always @ (posedge clk)</code> defines a circuit that is rising edge-triggered</li><li><code>&lt;=</code> is non-blocking register assignment</li><li><code>clk_count[19:17]</code> is a bitwise slice of the most significant 3 bits of the register <code>clk_count</code></li></ul><p>Rather counterintuitively, the anodes and digits are <em>both</em> active low. I didn&rsquo;t figure this out until I&rsquo;d spent an entire weekend debugging everything instead of just reading the docs ðŸ™ƒ.</p><p>Writing a simple verilog module to act as a controller was the easy part, integrating it with the existing SoC was the challenge. All the other I/O blocks are connected over an AXI4 bus, which is fairly simple to extend. AXI-4 is a bus interface specification developed by ARM as part of the AMBA (Advanced Microcontroller Bus Architecture) specification, it&rsquo;s a transaction-oriented master-slave interface with 5 channels. There are 3 types of AXI-4 interface:</p><ul><li>Full AXI, for high performance memory mapped I/O</li><li>AXI-Lite for simpler, low throughput memory mapped registers</li><li>AXI-Stream, for high speed streaming data</li></ul><p><figure><img class="my-0 rounded-md" src="https://xilinx--c.documentforce.com/servlet/servlet.ImageServer?id=0152E000003pLEj&oid=00D2E000000nHq7" alt="The AXI Interface"><figcaption>The AXI Interface (image from Xilinx)</figcaption></figure></p><p>I went with AXI Lite, as all I was connecting was 8 registers (one for each digit). Vivado includes a &ldquo;wizard&rdquo; to generate a template for an AXI IP block, so it created a new project for me with a top level module defining an AXI interface, and very kindly pointed out where to insert my own port and module instantiations. I instantiated my module and connected the bus registers to the display controller, and then added two new output ports to the block, <code>anode[7:0]</code> for the 8 anodes and <code>seg[6:0]</code> for the 7 segments.</p><p><figure><img class="my-0 rounded-md" src=./ip.png alt="IP block in Vivado"><figcaption>My very own IP core!</figcaption></figure></p><p>(The three input ports are clock, reset, and the AXI bus connection, which Vivado handles all the internal wires for.)</p><p>Adding my new IP to the design was relatively painless, just a few steps in the block diagram GUI to drop it in and connect the wires up. I had to also extend the I/O address space to memory-map my registers, and add a new constraints file to connect the output from the design to the peripherals. Constraints files contain information about the physical properties of the design (clocks, I/O, timing), and in this case they&rsquo;re used to connect the right wires on the design to the correct physical output pins on the FPGA chip.</p><p>To verify this worked I used Xilinx System Debugger (<code>xsdb</code>) to connect to the FPGA, which provides a neat little command line interface where you can poke and prod at running targets on an FPGA or Xilinx SoC. I manually wrote into the address I&rsquo;d mapped the registers to to verify that everything worked, which it did (after I remembered that the anodes were active low and fixed that).</p><h2 id=more-rust class="relative group">More Rust <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#more-rust aria-label=Anchor>#</a></span></h2><p>So the hardware works, but what about software? Writing a driver for the display device was fairly simple, just define an array of 8 registers and wrap it in a struct, and we can use the same pointer-cast technique from earlier to create the device.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>type</span> <span class=nc>DigitRegs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=n>RW</span><span class=o>&lt;</span><span class=kt>u32</span><span class=o>&gt;</span><span class=p>;</span><span class=w> </span><span class=mi>8</span><span class=p>];</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[repr(C)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>pub</span><span class=w> </span><span class=k>struct</span> <span class=nc>Display</span><span class=p>(</span><span class=o>&amp;&#39;</span><span class=nb>static</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>DigitRegs</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>impl</span><span class=w> </span><span class=n>Display</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=k>unsafe</span><span class=w> </span><span class=k>fn</span> <span class=nf>new</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>Self</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Display</span><span class=p>((</span><span class=n>DISPLAY_ADDR</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=o>*</span><span class=k>mut</span><span class=w> </span><span class=n>DigitRegs</span><span class=p>).</span><span class=n>as_mut</span><span class=p>().</span><span class=n>unwrap</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>take</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Option</span><span class=o>&lt;</span><span class=bp>Self</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>singleton</span><span class=o>!</span><span class=p>(</span>:<span class=kp>&amp;</span><span class=o>&#39;</span><span class=nb>static</span> <span class=nc>mut</span><span class=w> </span><span class=n>DigitRegs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>unsafe</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=n>DISPLAY_ADDR</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=o>*</span><span class=k>mut</span><span class=w> </span><span class=n>DigitRegs</span><span class=p>).</span><span class=n>as_mut</span><span class=p>()</span><span class=o>?</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>regs</span><span class=o>|</span><span class=w> </span><span class=n>Display</span><span class=p>(</span><span class=n>regs</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The intended way to get an instance of the struct is through the <code>take</code> method. It makes use of the <a href=https://docs.rs/riscv/latest/riscv/macro.singleton.html><code>singleton!</code></a> macro from the <code>riscv</code> architecture crate, that will return a <code>Some(T)</code> the first time it is called, but a <code>None</code> every time after that. This ensures that we only have one instance of our peripheral struct, which prevents multiple concurrent accesses leading to race conditions, etc. We use it to create a <code>&'static mut DigitRegs</code> from a pointer to the address where they are, and then wrap that in a struct to create the display device. It&rsquo;s a neat little bit of unsafe rust, and we&rsquo;re still trying to use the type system to our advantage to enforce safety.</p><p>I wanted to implement the <code>Index</code> and <code>IndexMut</code> traits for <code>Display</code>, but this turned out to not be possible. The <code>Index</code> trait looks like this (slightly simplified, and with lifetime annotations added):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>pub</span><span class=w> </span><span class=k>trait</span><span class=w> </span><span class=n>Index</span><span class=o>&lt;</span><span class=n>Idx</span><span class=o>&gt;</span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>type</span> <span class=nc>Output</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>fn</span> <span class=nf>index</span><span class=o>&lt;&#39;</span><span class=na>a</span><span class=o>&gt;</span><span class=p>(</span><span class=o>&amp;&#39;</span><span class=na>a</span><span class=w> </span><span class=bp>self</span><span class=p>,</span><span class=w> </span><span class=n>index</span>: <span class=nc>Idx</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kp>&amp;</span><span class=o>&#39;</span><span class=na>a</span> <span class=nc>Self</span>::<span class=n>Output</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Index has to return a reference, the lifetime of which is the same as the lifetime of <code>self</code>. In this case, that would be <code>'static</code>. However, under the hood, our data is accessed using <a href=https://doc.rust-lang.org/std/ptr/fn.read_volatile.html><code>ptr::volatile_read</code></a>, which returns <code>T</code>, not <code>&T</code> or <code>&mut T</code>. We can&rsquo;t actually get a reference to the data in our registers safely, so we can&rsquo;t satisfy the requirements for <code>Index</code>. Or <code>IndexMut</code>. Instead, I settled for boring old <code>fn get(&self, idx: usize) -> u32</code> and <code>fn set(&mut self, idx: usize, val: u32)</code>.</p><p>With the API all set up, I wrote a little demo program that rotated the digits 0-9 across the display, which is what&rsquo;s running in the gif from further up.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=c1>//init the 8 digits
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=o>..</span><span class=mi>8</span><span class=p>).</span><span class=n>rev</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>display</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>u32</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>loop</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//shift all the digits along
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=o>..</span><span class=mi>8</span><span class=p>).</span><span class=n>rev</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>display</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>display</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//set the last digit to 1+ the prev value
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>display</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>display</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>10</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>//write the digits to the serial device too
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>0</span><span class=o>..</span><span class=mi>8</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>serial</span><span class=p>.</span><span class=n>write_byte</span><span class=p>(</span><span class=n>display</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>u8</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>48</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34; &#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>delay</span><span class=p>.</span><span class=n>delay_ms</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=conclusion class="relative group">Conclusion <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h2><p>This was a really fun little project, getting to play around with loads of different aspects of embedded and digital systems design that I&rsquo;m interested in, and that I&rsquo;m going to be doing more of next year. There was a <em>lot</em> of trial and error, poring over Xilinx documentation, and fighting Vivado (when it wasn&rsquo;t crashing), but its those kinds of experiences where you often end up learning the most. It really didn&rsquo;t come together anywhere near as cleanly as I&rsquo;ve probably made out.</p><p>There&rsquo;s a lot more I want to explore too. CHISEL seems super interesting, I like the idea of using a functional language to build circuits (with an actual type system to enforce design constraints). I also barely scratched the surface with AXI, and Vivado did most of the work for me: I&rsquo;ll need to be a lot more familiar with it for designing more complex I/O devices, especially AXI-Stream for the kind of high throughput design I have in mind.</p><p>I also want to thank Eugene Tarassov for the GitHub repo that provided the block design and scripts for the RISC-V SoC. I wouldn&rsquo;t have had a clue where to even start without that, and it will probably end up being the starting point for my actual project</p></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=flex><img class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full" width=96 height=96 alt="Joey Harrison" src=/img/joey_hu354e5b8eeaa52931ef012a3f89e43f5a_743245_192x192_fill_box_smart1_3.png><div class=place-self-center><div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Joey Harrison</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/Joeyh021 target=_blank aria-label=Github rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://linkedin.com/in/joe-h-a991771b6/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/Joeyh021 target=_blank aria-label=Twitter rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:joeyh021@icloud.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></div></div></div></div></footer></article><div class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"><a href=#the-top class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Joey Harrison</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div></div></footer></div></body></html>